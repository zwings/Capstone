<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
    <link rel="stylesheet" href="Shop_page_files/bootstrap.css">
    <link rel="stylesheet" href="Shop_page_files/Shop_page.css">
    <script src="Shop_page_files/jquery.js"></script>
    <script src="Shop_page_files/bootstrap.js"></script>
    <script src="Shop_page_files/contentful.js"></script>
</head>

<body style="" class="">
    <!--template for bird icons-->
    <div id="birds-icons-template" style="display:none;">
        <div class="img-container grid-row col-md-6 col-lg-3">
            <img class="birds-icons-img-template">
        </div>
    </div>

    <!-- bird data card modal template-->
    <div style="display: none;">
        <div id="bird-data-card-template" class="modal-dialog">
            <!-- bird-data-card content-->
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <img class="modal-image" src="background:url('')">
                </div>
                <div class="modal-footer">
                    <div class="type">Lovebird</div>
                    <div class="descripiton">
                        <p class="properties">Lovebird is a small size bird, with green color feather, and it's 2 years old now.</p>
                        <p class="price">Price:$100</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="birds-icons-container" class="row">
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="0" class="birds-icons-img" src="Shop_page_files/pink-cockatoo-major-mitchell-australia-zoo-5-1360993.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="1" class="birds-icons-img" src="Shop_page_files/Golden-Conure.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="2" class="birds-icons-img" src="Shop_page_files/c27d46723b632bb44ff12a71d30c52f7--opaline-love-birds.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="3" class="birds-icons-img" src="Shop_page_files/63737371-1280px.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="4" class="birds-icons-img" src="Shop_page_files/756-2b.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="5" class="birds-icons-img" src="Shop_page_files/150427145127_1_540x360.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="6" class="birds-icons-img" src="Shop_page_files/67385111-1280px.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="7" class="birds-icons-img" src="Shop_page_files/cockatoo-on-fence-white.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="8" class="birds-icons-img" src="Shop_page_files/Eleanora.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="9" class="birds-icons-img" src="Shop_page_files/68033861-1280px.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="10" class="birds-icons-img" src="Shop_page_files/australian-king-parrot-alisterus-scapularis-113614.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="11" class="birds-icons-img" src="Shop_page_files/blue-yellow-macow.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="12" class="birds-icons-img" src="Shop_page_files/White-bellied-Caique_3370_960.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="13" class="birds-icons-img" src="Shop_page_files/Palm-Cockatoo.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="14" class="birds-icons-img" src="Shop_page_files/25709733-606-640x958.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="15" class="birds-icons-img" src="Shop_page_files/4874958521_18eb7bf977_b.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="16" class="birds-icons-img" src="Shop_page_files/562413855-1024x1024.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="17" class="birds-icons-img" src="Shop_page_files/2827091_orig.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="18" class="birds-icons-img" src="Shop_page_files/angry-parroyt_1439892652.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="19" class="birds-icons-img" src="Shop_page_files/Eclectus_roratus_-Bali_Zoo__Indonesia_-male-8a.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="20" class="birds-icons-img" src="Shop_page_files/black-masked-lovebird-3-409x420.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="21" class="birds-icons-img" src="Shop_page_files/63667361-1280px.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="22" class="birds-icons-img" src="Shop_page_files/68043591-1280px.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="23" class="birds-icons-img" src="Shop_page_files/a2f9539c378e806f4349e6af275ac6ef.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="24" class="birds-icons-img" src="Shop_page_files/photo-1430990480609-2bf7c02a6b1a.jpeg"></div>
    
        <div class="img-container grid-row col-md-6 col-lg-3"><img id="25" class="birds-icons-img" src="Shop_page_files/black-mask-lovebird-for-sale-in-vancouver-wa.jpeg"></div>
    </div>

    <div id="bird-data-card" class="modal fade" role="dialog" style="display: none;"></div>

    <script type="text/javascript">

        $().ready(()=>{
        // Set up api call.
        let cdaClient = contentful.createClient({
            space: "bqnchs7z0iy5",
            accessToken: "c0685fb14294207d1308e272df9fe0da5d6651c2efec7a4ee2c519f310ddb1d2"
        });
        var birdsArr = [];
        // Get all the entires of content-type from server.
        cdaClient.getEntries({ content_type: "birdType" })
            .then((result) => result.items)
            .then((items) => items.map((item) => item.fields))
            .then((output) => output.map((item) => {
                return { ...item, photo: item.photo.fields.file.url }
            }))
            .then((items) => items.forEach((item) => {
                birdsArr.push({ ...item, id: birdsArr.length })
            }))
            .then(constructIcon)
            .then(getBirdDataViaUrl)
            
        // Append the data retrived from Contentful to HTML. 
        function constructIcon() {
            birdsArr.forEach((e) => {
                let iconTemplate = $('#birds-icons-template').clone();
                let iconContainer = iconTemplate[0].children;
                iconContainer[0].innerHTML = `<img id="${e.id}"class="birds-icons-img" src="http:${e.photo}">`;
                let iconsContainer = $("#birds-icons-container");
                iconsContainer.append(iconTemplate.html());
            });
        }

        // Event handler
        $("#birds-icons-container").click(".icons-img", function (e) {
            console.log(e.target.id);
            constructBirdData(e.target.id);
        });

        $("#bird-data-card").on('hidden.bs.modal', function (e) {
            e.target.innerHTML = "";
        })
        // 
        

        // Get corresponding Bird ID from URL
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        // Create a sudo event to trigger modal via URL
        function getBirdDataViaUrl () {
            console.log("I'm running")
            var birdId = getParameterByName('birdId');
            if (!!birdId){
                $("#birds-icons-container").children().eq(Number(birdId)).children().eq(0).click()
                }
        };
       
        function constructBirdData(targetId) {
            data = birdsArr[Number(targetId)];

            console.log(data);

            let dataTemplate = $("#bird-data-card-template").clone();

            console.log(dataTemplate);

            let dataBody = dataTemplate[0].getElementsByClassName("modal-body")[0];

            console.log(dataBody);

            let image = dataBody.children[1];
            image.src = `http:${data.photo}`;
            console.log(image);
            
            let dataFooter = dataTemplate[0].getElementsByClassName("modal-footer")[0];
            console.log(dataFooter);

            let type = dataFooter.children[0];
            type.innerHTML = `${data.type}`;
            console.log(type);
            

            let descripiton = dataFooter.children[1];
            console.log(descripiton);

            let properties = descripiton.children[0];
            let price = descripiton.children[1];
            properties.innerHTML = `${data.type} is a ${data.size} size bird, with ${data.color} color feather, and it's ${data.age} years old now.`;
            price.innerHTML = `$${data.price}`;

            console.log(properties);
            console.log(price);

            let dataContainer = $("#bird-data-card");
            dataContainer.append(dataTemplate.html());
            $('#bird-data-card').modal('show');
        };

        });


    </script>



</body></html>